/*
 * PREGUNTAR IMPLEMENTACION 30 SEGUNDOS
 */
package filosofosmonitor;

import java.util.Random;

public class FilosofosMonitor extends Thread {
    static final int NUM_THREADS = 5;
    
    private volatile boolean matados[] = {false,false,false,false,false};
    private int id;    
    private static SalaComida dr = new SalaComida();
   
    static Random generador = new Random();
    public FilosofosMonitor(int id) {
        this.id = id;
    }
    public void pensando() { 
        try {
            int piensa = generador.nextInt(1501-500) + 500;
            Thread.sleep(piensa);
        }catch(InterruptedException e) { /*System.out.println("error en pensando");*/ }
    }
    @Override
    public void run() {
        while(!matados[id]) {
            try {           
                doIt();
            }catch (InterruptedException ie) { /**/ matados[id] = true; }
        }
    }
    private void doIt() throws InterruptedException { 
        pensando();
        dr.comer(id);
    }
            
  
    private void corre() {
        new java.util.Timer().schedule(
                new java.util.TimerTask() {
                    @Override
                    public void run() {        
                        System.out.println("hi");
                        while(true) {            
                            pensando();            
                            dr.comer(id);
                        }    
                    }
                },
                30000
                );        
    }
    public static void main(String[] args) {
        Thread[] threads = new Thread[NUM_THREADS];
        int i;
        for(i = 0; i < threads.length; i++) {
            threads[i] = new filosofosmonitor.FilosofosMonitor(i);
            threads[i].start();
        }
        try {
            Thread.sleep(10000);        
            for ( Thread t : threads)
                t.interrupt();
        }catch(Exception e) { }
       
        for(i = 0; i < threads.length; i++) {
            try {
                threads[i].join();       
            }catch(Exception e) {}            
        }   
        SalaComida.muestraResultado();
        System.exit(0);
    }
}
